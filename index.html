<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <base href="./">
  <title>Dashboard ‚Äì Sistema de Filtros</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <script>
    const token = localStorage.getItem('token');
    if (!token) {
      window.location.href = 'login.html';
    }
  </script>

  <div class="layout">
    <div class="col-filtros">
      <h1 class="app-title">FILTERTRACK</h1>
      <button id="btn-logout" style="float:right;">Cerrar sesi√≥n</button>

      <form id="form-filtro">
        <h2>Agregar filtro (V1)</h2>

        <input type="text" id="filter-id" name="filter_id" placeholder="Filter ID (ej. FT-BAR-ICE-001)" required />
        <input type="text" id="area" name="area" placeholder="√Årea (ej. BAR)" required />
        <input type="text" id="equipment" name="equipment" placeholder="Equipo/M√°quina (ej. ICE-01)" required />
        <input type="text" id="location" name="location" placeholder="Ubicaci√≥n exacta" required />

        <input type="text" id="brand" name="brand" placeholder="Marca" required />
        <input type="text" id="model" name="model" placeholder="Modelo" required />

        <input type="date" id="install-date" name="install_date" required />
        <input type="number" id="life-months" name="life_months" placeholder="Vida √∫til (meses)" min="1" step="1" required />

        <input type="text" id="responsible" name="responsible" placeholder="Responsable (iniciales o nombre)" required />
        <input type="text" id="notes" name="notes" placeholder="Notas (opcional)" />

        <button type="submit">Guardar filtro</button>
        <button type="button" id="btn-limpiar">Limpiar campos</button>
      </form>

      <div class="estado-bar">
        <button class="estado-btn activo" data-estado="all">
          Todos (<span id="count-all">0</span>)
        </button>

        <button class="estado-btn" data-estado="proximo">
          Pr√≥ximos (<span id="count-proximo">0</span>)
        </button>

        <button class="estado-btn" data-estado="vencido">
          Vencidos (<span id="count-vencido">0</span>)
        </button>
      </div>

      <button id="btn-reporte-filtros" class="btn-reporte" title="Generar reporte de filtros">
        üñ®Ô∏è
      </button>

      <table id="tabla-filtros">
        <thead>
          <tr>
            <th>Filter ID</th>
            <th>√Årea</th>
            <th>Equipo</th>
            <th>Ubicaci√≥n</th>
            <th>Marca/Modelo</th>
            <th>Instalaci√≥n</th>
            <th>Vence</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <!-- JS inserta filas aqu√≠ -->
        </tbody>
      </table>
    </div>

    <div class="col-mantenimientos">
      <button id="btn-cerrar-panel" style="float:right;">‚úï</button>
      <h2>Historial del filtro</h2>
      <button id="btn-reporte-mantenimientos" class="btn-reporte" title="Generar reporte de historial">
        üñ®Ô∏è
      </button>

      <div id="seccion-mantenimientos" style="display:none;">
        <h3 id="titulo-mantenimientos"></h3>

        <form id="form-mantenimiento">
          <input type="date" id="mant-fecha" required />
          <select id="mant-motivo" required>
            <option value="">Motivo</option>
            <option value="Programado">Programado</option>
            <option value="Emergencia">Emergencia</option>
            <option value="Calidad">Calidad</option>
            <option value="Flujo bajo">Flujo bajo</option>
            <option value="Da√±o">Da√±o</option>
            <option value="Otro">Otro</option>
          </select>
          <input type="text" id="mant-responsable" placeholder="Responsable" required />
          <input type="text" id="mant-observaciones" placeholder="Notas / Observaciones" />
          <button type="submit">Guardar evento</button>
        </form>

        <table id="tabla-mantenimientos">
          <thead>
            <tr>
              <th>ID</th>
              <th>Fecha</th>
              <th>Motivo</th>
              <th>Responsable</th>
              <th>Notas</th>
            </tr>
          </thead>
          <tbody>
            <!-- JS inserta mantenimientos aqu√≠ -->
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    document.getElementById('btn-logout')?.addEventListener('click', () => {
      localStorage.removeItem('token');
      window.location.href = 'login.html';
    });
  </script>
  <script src="script.js"></script>
  <div id="overlay" class="overlay"></div>
</body>
</html>